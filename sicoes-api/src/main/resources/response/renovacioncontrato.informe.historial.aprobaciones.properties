# Configuración RAML para el endpoint de historial de aprobaciones
# GET /informe/renovacion/historial-aprobaciones

# Descripción del endpoint
endpoint.description=Lista el historial de aprobaciones de informes de renovación de contrato con filtros avanzados
endpoint.displayName=Historial de Aprobaciones - Grupo 8
endpoint.group=Historial de Aprobaciones
endpoint.subgroup=Bandeja Aprobaciones
endpoint.groupNumber=Grupo 8
endpoint.version=1.0
endpoint.action=Listar

# Parámetros de consulta
query.numeroExpediente.description=Número de expediente para filtrar historial
query.numeroExpediente.required=false
query.numeroExpediente.type=string
query.numeroExpediente.maxLength=50
query.numeroExpediente.example=EXP-2024-0001

query.tipoSector.description=Tipo de sector (ELECTRICO, GAS, etc.)
query.tipoSector.required=false
query.tipoSector.type=string
query.tipoSector.maxLength=50
query.tipoSector.example=ELECTRICO

query.tipoSubSector.description=Tipo de subsector
query.tipoSubSector.required=false
query.tipoSubSector.type=string
query.tipoSubSector.maxLength=50
query.tipoSubSector.example=TRANSMISION

query.nombreItem.description=Nombre del item de la renovación
query.nombreItem.required=false
query.nombreItem.type=string
query.nombreItem.maxLength=200
query.nombreItem.example=Supervisión de obras

query.razSocialSupervisora.description=Razón social de la empresa supervisora
query.razSocialSupervisora.required=false
query.razSocialSupervisora.type=string
query.razSocialSupervisora.maxLength=200
query.razSocialSupervisora.example=SUPERVISORA ABC S.A.C.

query.estadoFinal.description=Estado final del proceso (1=Pendiente, 2=En_Revision, 3=Aprobado, 4=Rechazado)
query.estadoFinal.required=false
query.estadoFinal.type=integer
query.estadoFinal.enum=[1,2,3,4]
query.estadoFinal.example=3

query.tipoAccion.description=Tipo de acción realizada (APROBACION, RECHAZO, CAMBIO_ESTADO)
query.tipoAccion.required=false
query.tipoAccion.type=string
query.tipoAccion.enum=[APROBACION,RECHAZO,CAMBIO_ESTADO]
query.tipoAccion.example=APROBACION

query.grupoAprobador.description=Grupo aprobador (1=Grupo_1, 2=Grupo_2, 7=GSE, 8=Grupo_8)
query.grupoAprobador.required=false
query.grupoAprobador.type=integer
query.grupoAprobador.enum=[1,2,7,8]
query.grupoAprobador.example=8

query.idUsuarioAccion.description=ID del usuario que realizó la acción
query.idUsuarioAccion.required=false
query.idUsuarioAccion.type=integer
query.idUsuarioAccion.example=123

query.fechaDesde.description=Fecha desde para filtrar por fecha de acción (formato dd/MM/yyyy)
query.fechaDesde.required=false
query.fechaDesde.type=string
query.fechaDesde.pattern=^\\d{2}/\\d{2}/\\d{4}$
query.fechaDesde.example=01/01/2024

query.fechaHasta.description=Fecha hasta para filtrar por fecha de acción (formato dd/MM/yyyy)
query.fechaHasta.required=false
query.fechaHasta.type=string
query.fechaHasta.pattern=^\\d{2}/\\d{2}/\\d{4}$
query.fechaHasta.example=31/12/2024

query.soloAprobados.description=Mostrar solo registros de aprobaciones
query.soloAprobados.required=false
query.soloAprobados.type=boolean
query.soloAprobados.default=false
query.soloAprobados.example=true

query.soloRechazados.description=Mostrar solo registros de rechazos
query.soloRechazados.required=false
query.soloRechazados.type=boolean
query.soloRechazados.default=false
query.soloRechazados.example=false

query.soloMisAcciones.description=Mostrar solo acciones realizadas por el usuario actual
query.soloMisAcciones.required=false
query.soloMisAcciones.type=boolean
query.soloMisAcciones.default=false
query.soloMisAcciones.example=false

# Parámetros de paginación
query.page.description=Número de página (iniciando en 0)
query.page.required=false
query.page.type=integer
query.page.default=0
query.page.example=0

query.size.description=Tamaño de página
query.size.required=false
query.size.type=integer
query.size.default=10
query.size.example=10

query.sort.description=Campo y dirección de ordenamiento
query.sort.required=false
query.sort.type=string
query.sort.example=fechaAccion,desc

# Respuesta exitosa
response.200.description=Lista paginada del historial de aprobaciones
response.200.type=Page<HistorialAprobacionDTO>
response.200.example={"content":[{"idHistorialAprobacion":1,"idInformeRenovacion":123,"numeroExpediente":"EXP-2024-0001","nombreItem":"Supervisión de obras","tipoSector":"ELECTRICO","tipoSubSector":"TRANSMISION","razSocialSupervisora":"SUPERVISORA ABC S.A.C.","numeroRucSupervisora":"20123456789","nombreRepresentante":"Juan Pérez García","estadoAnterior":1,"descripcionEstadoAnterior":"Pendiente","estadoNuevo":3,"descripcionEstadoNuevo":"Aprobado","accionRealizada":"Aprobó el informe","fechaAccion":"2024-01-15T14:30:00","idUsuarioAccion":456,"nombreUsuarioAccion":"María López Rodríguez","rolUsuarioAccion":"APROBADOR_GSE","grupoAprobador":7,"descripcionGrupoAprobador":"GSE","observaciones":"Informe aprobado sin observaciones","justificacion":"Cumple con todos los requisitos técnicos","tipoAccion":"APROBACION","montoAprobado":150000.00,"moneda":"PEN","diasProcesamiento":5,"comentarios":"Procesado dentro del plazo establecido","documentosSoporte":"adjunto_123.pdf","numeroResolucion":"RES-2024-001","fechaNotificacion":"2024-01-15T16:00:00","canalNotificacion":"EMAIL","idRequerimientoRenovacion":789,"estadoFinalProceso":"Aprobado","orden":1}],"pageable":{"sort":{"sorted":false,"unsorted":true,"empty":true},"pageNumber":0,"pageSize":10,"offset":0,"unpaged":false,"paged":true},"totalElements":1,"totalPages":1,"last":true,"first":true,"numberOfElements":1,"size":10,"number":0,"sort":{"sorted":false,"unsorted":true,"empty":true},"empty":false}

# Respuestas de error
response.400.description=Parámetros de consulta inválidos
response.400.type=object
response.400.example={"error":"Bad Request","message":"Formato de fecha inválido","timestamp":"2024-01-15T10:30:00Z"}

response.403.description=Sin permisos para acceder al historial de aprobaciones
response.403.type=object
response.403.example={"error":"Forbidden","message":"No tiene permisos para acceder al historial de aprobaciones","timestamp":"2024-01-15T10:30:00Z"}

response.500.description=Error interno del servidor
response.500.type=object
response.500.example={"error":"Internal Server Error","message":"Error al procesar la consulta del historial","timestamp":"2024-01-15T10:30:00Z"}

# Headers de respuesta
header.Content-Type.description=Tipo de contenido de la respuesta
header.Content-Type.type=string
header.Content-Type.example=application/json

# Seguridad
security.required=true
security.type=bearer
security.description=Token JWT requerido para autenticación y autorización

# Roles autorizados
security.roles=APROBADOR,GSE,TECNICO,ADMIN,SUPERVISOR,AUDITOR,CONSULTOR
security.roles.description=Solo usuarios con estos roles pueden acceder al historial de aprobaciones

# Tags para documentación
tags=Renovación de Contratos,Historial,Aprobaciones,Auditoría,Trazabilidad

# Notas adicionales
notes.usage=Este endpoint permite consultar el historial completo de aprobaciones y rechazos de informes de renovación de contrato. Proporciona trazabilidad completa de las acciones realizadas.

notes.security=El endpoint requiere autenticación JWT y valida que el usuario tenga permisos para acceder al historial. Los administradores y auditores tienen acceso completo, mientras que otros usuarios pueden tener acceso limitado según su grupo:
notes.security.admin=Administradores y auditores ven todo el historial
notes.security.gse=Usuarios GSE ven historial de su grupo
notes.security.tecnico=Usuarios técnicos ven historial de sus asignaciones
notes.security.personal=Todos pueden filtrar por sus propias acciones

notes.filters=Filtros disponibles:
notes.filters.basic=Filtros básicos por expediente, sector, item, supervisora
notes.filters.status=Filtros por estado final y tipo de acción
notes.filters.dates=Filtros por rango de fechas de acción
notes.filters.user=Filtros por usuario que realizó la acción
notes.filters.special=Filtros especiales para aprobaciones, rechazos y acciones propias

notes.actions=Tipos de acciones registradas:
notes.actions.approval=APROBACION: Informes que fueron aprobados
notes.actions.rejection=RECHAZO: Informes que fueron rechazados
notes.actions.change=CAMBIO_ESTADO: Otros cambios de estado del informe

notes.audit=Todas las consultas al historial se registran en la bitácora del sistema para mantener trazabilidad de auditoría.

notes.pagination=La respuesta está paginada. Use los parámetros page y size para controlar la paginación.

notes.sorting=Se puede ordenar por cualquier campo del DTO de respuesta. Campos recomendados:
notes.sorting.date=fechaAccion,desc - Por fecha de acción descendente (más recientes primero)
notes.sorting.user=nombreUsuarioAccion,asc - Por nombre de usuario ascendente
notes.sorting.action=tipoAccion,asc - Por tipo de acción ascendente
notes.sorting.state=estadoNuevo,asc - Por estado nuevo ascendente

notes.performance=Para grandes volúmenes de historial, considere usar filtros específicos de fecha y usuario para mejorar el rendimiento.

notes.data_retention=El historial se mantiene según las políticas de retención de datos de la organización. Los registros históricos no se eliminan físicamente.

# Ejemplos de uso
example.request.basic=GET /informe/renovacion/historial-aprobaciones?grupoAprobador=8&tipoAccion=APROBACION&page=0&size=20
example.request.basic.description=Consulta básica del historial de aprobaciones del grupo 8

example.request.user_actions=GET /informe/renovacion/historial-aprobaciones?soloMisAcciones=true&sort=fechaAccion,desc
example.request.user_actions.description=Consulta de acciones realizadas por el usuario actual

example.request.date_range=GET /informe/renovacion/historial-aprobaciones?fechaDesde=01/01/2024&fechaHasta=31/01/2024&soloAprobados=true
example.request.date_range.description=Consulta de aprobaciones en un rango de fechas específico

example.request.audit_trail=GET /informe/renovacion/historial-aprobaciones?numeroExpediente=EXP-2024-0001&sort=fechaAccion,asc
example.request.audit_trail.description=Seguimiento cronológico de un expediente específico

example.request.rejection_analysis=GET /informe/renovacion/historial-aprobaciones?soloRechazados=true&idUsuarioAccion=123
example.request.rejection_analysis.description=Análisis de rechazos realizados por un usuario específico

# Configuración específica
business.rules.chronology=Los registros se ordenan cronológicamente por defecto (más recientes primero)
business.rules.completeness=Se registran todas las acciones de cambio de estado de los informes
business.rules.immutability=Los registros del historial son inmutables una vez creados
business.rules.visibility=La visibilidad del historial depende del rol y permisos del usuario

# Campos de respuesta importantes
response.fields.tracking=Los campos idHistorialAprobacion e idInformeRenovacion permiten trazabilidad completa
response.fields.temporal=fechaAccion y diasProcesamiento proporcionan información temporal
response.fields.user=nombreUsuarioAccion y rolUsuarioAccion identifican al responsable
response.fields.business=estadoAnterior, estadoNuevo y tipoAccion describen el cambio realizado

# Casos de uso típicos
use_cases.audit=Auditoría de decisiones de aprobación y rechazo
use_cases.performance=Análisis de tiempos de procesamiento por usuario/grupo
use_cases.compliance=Verificación de cumplimiento de procedimientos de aprobación
use_cases.reporting=Generación de reportes de gestión y control
use_cases.investigation=Investigación de incidentes o consultas específicas