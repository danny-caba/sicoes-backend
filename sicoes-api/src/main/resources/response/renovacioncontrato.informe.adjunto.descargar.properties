# Configuración RAML para el endpoint de descarga de adjuntos de informe de renovación
# GET /informe/renovacion/adjunto/descargar

# Descripción del endpoint
endpoint.description=Descarga adjuntos de informes de renovación de contrato desde Alfresco
endpoint.displayName=Descargar Adjunto de Informe de Renovación
endpoint.group=Informe Presupuestal
endpoint.version=1.0
endpoint.action=Descargar

# Parámetros de consulta
query.uuid.description=UUID único del archivo en Alfresco a descargar
query.uuid.required=true
query.uuid.type=string
query.uuid.pattern=^[a-zA-Z0-9\\-_]{8,}$
query.uuid.example=abc123def456-7890-uuid-example-12345678

query.nombreArchivo.description=Nombre opcional para el archivo descargado
query.nombreArchivo.required=false
query.nombreArchivo.type=string
query.nombreArchivo.maxLength=255
query.nombreArchivo.example=informe_presupuestal.pdf

# Respuesta exitosa
response.200.description=Archivo descargado exitosamente
response.200.type=binary/octet-stream
response.200.headers.Content-Disposition=attachment; filename="archivo.ext"
response.200.headers.Content-Type=application/pdf, application/octet-stream, image/jpeg, etc.
response.200.headers.Content-Length=Tamaño del archivo en bytes
response.200.headers.Cache-Control=no-cache, no-store, must-revalidate
response.200.headers.Pragma=no-cache
response.200.headers.Expires=0

# Respuestas de error
response.400.description=Parámetros de consulta inválidos o UUID malformado
response.400.type=object
response.400.example={"error":"Bad Request","message":"UUID del archivo es requerido","timestamp":"2024-01-15T10:30:00Z"}

response.403.description=Sin permisos para descargar el adjunto o acceso denegado al archivo
response.403.type=object
response.403.example={"error":"Forbidden","message":"No tiene permisos para descargar este archivo","timestamp":"2024-01-15T10:30:00Z"}

response.404.description=Archivo no encontrado en Alfresco
response.404.type=object
response.404.example={"error":"Not Found","message":"Archivo no encontrado","timestamp":"2024-01-15T10:30:00Z"}

response.500.description=Error interno del servidor o problema con Alfresco
response.500.type=object
response.500.example={"error":"Internal Server Error","message":"Error al descargar el archivo desde Alfresco","timestamp":"2024-01-15T10:30:00Z"}

# Headers de respuesta
header.Content-Type.description=Tipo MIME del archivo descargado
header.Content-Type.type=string
header.Content-Type.examples=application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,image/jpeg

header.Content-Disposition.description=Indica que el contenido debe descargarse como adjunto
header.Content-Disposition.type=string
header.Content-Disposition.example=attachment; filename="informe.pdf"

header.Content-Length.description=Tamaño del archivo en bytes
header.Content-Length.type=integer
header.Content-Length.example=1048576

# Seguridad
security.required=true
security.type=bearer
security.description=Token JWT requerido para autenticación y autorización

# Roles autorizados
security.roles=APROBADOR,TECNICO,ADMIN,EVALUADOR,CONSULTOR
security.roles.description=Solo usuarios con estos roles pueden descargar adjuntos

# Tags para documentación
tags=Renovación de Contratos,Informes Presupuestales,Adjuntos,Alfresco,Descargas

# Notas adicionales
notes.usage=Este endpoint permite descargar adjuntos de informes de renovación de contrato almacenados en Alfresco usando su UUID único. El archivo se descarga directamente al navegador del usuario.

notes.security=El endpoint requiere autenticación JWT y valida que el usuario tenga permisos para descargar adjuntos. Adicionalmente verifica que el usuario tenga acceso específico al archivo solicitado.

notes.alfresco=Los archivos se obtienen desde Alfresco ECM usando la ruta /archivos/{uuid}/descarga. El UUID debe corresponder a un archivo válido y accesible.

notes.audit=Todas las descargas se registran en la bitácora del sistema para fines de auditoría, incluyendo el UUID del archivo, tamaño y usuario que realizó la descarga.

notes.formats=El endpoint soporta múltiples tipos de archivo incluyendo PDF, documentos de Office, imágenes y otros formatos binarios. El Content-Type se determina automáticamente basado en la extensión del archivo.

notes.validation=Se realizan múltiples validaciones de seguridad:
notes.validation.1=Validación del formato del UUID
notes.validation.2=Verificación de permisos del usuario
notes.validation.3=Validación de acceso específico al archivo
notes.validation.4=Sanitización del UUID para prevenir path traversal

notes.performance=Para archivos grandes, considere implementar descarga por chunks o streaming para mejorar el rendimiento y reducir el uso de memoria.

notes.errors=Los errores específicos de Alfresco (404, 403, 500) se mapean a códigos HTTP apropiados con mensajes descriptivos para facilitar la depuración.

# Ejemplos de uso
example.request.description=Descarga de adjunto con UUID específico
example.request.url=GET /informe/renovacion/adjunto/descargar?uuid=abc123def456-7890-uuid-example-12345678&nombreArchivo=informe_tecnico.pdf
example.request.headers.Authorization=Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

example.response.success=HTTP/1.1 200 OK
example.response.success.headers=Content-Type: application/pdf
example.response.success.headers.2=Content-Disposition: attachment; filename="informe_tecnico.pdf"
example.response.success.headers.3=Content-Length: 2048576
example.response.success.body=[BINARY CONTENT]

# Configuración específica de Alfresco
alfresco.endpoint.pattern=/archivos/{uuid}/descarga
alfresco.timeout.seconds=30
alfresco.max.file.size.mb=50